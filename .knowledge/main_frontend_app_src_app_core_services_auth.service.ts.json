{"is_source_file": true, "format": "TypeScript", "description": "This file defines an Angular service class 'AuthService' responsible for managing authentication flows, token handling, OTP verification, and password reset functionalities. It includes interfaces for payloads and responses related to authentication.", "external_files": ["./api.service"], "external_methods": ["inject", "isPlatformBrowser", "post", "setItem", "getItem", "removeItem", "_isAuthed"], "published": ["AuthService", "LoginPayload", "OtpPayload", "ForgotPayload", "ResetPayload", "AuthResponse"], "classes": [{"name": "AuthService", "description": "An Angular service class that manages authentication processes, token storage (including SSR considerations), OTP verification, and password management."}], "methods": [{"name": "login", "description": "Performs login by calling backend API; stores token if received; handles OTP requirement."}, {"name": "verifyOtp", "description": "Verifies OTP with backend; stores JWT token upon success."}, {"name": "forgotPassword", "description": "Initiates forgot password flow by invoking backend API."}, {"name": "resetPassword", "description": "Completes password reset process via backend API."}, {"name": "logout", "description": "Clears stored tokens and marks the user as logged out."}, {"name": "isAuthenticated", "description": "Checks if a user is currently authenticated."}, {"name": "getToken", "description": "Retrieves the current auth token, SSR-safe."}, {"name": "setToken", "description": "Stores the auth token; updates authentication state."}, {"name": "setOtpToken", "description": "Stores OTP token temporarily."}, {"name": "getOtpToken", "description": "Retrieves OTP token if stored."}, {"name": "clearOtpToken", "description": "Removes stored OTP token."}], "calls": ["this.api.post", "this._isAuthed()", "this.setToken", "this.setOtpToken", "this.getOtpToken", "this.clearOtpToken", "this.isBrowser", "localStorage.removeItem", "localStorage.setItem", "localStorage.getItem"], "search-terms": ["AuthService", "OTP token management", "SSR-safe local storage", "login flow", "OTP verification", "password reset"], "state": 2, "file_id": 24, "knowledge_revision": 81, "git_revision": "8f7dab55cc2010ab26127ae81d075c9ecbb8a8ce", "revision_history": [{"56": ""}, {"75": ""}, {"78": ""}, {"80": "8f7dab55cc2010ab26127ae81d075c9ecbb8a8ce"}, {"81": "8f7dab55cc2010ab26127ae81d075c9ecbb8a8ce"}], "ctags": [{"_type": "tag", "name": "AuthResponse", "path": "/home/kavia/workspace/code-generation/secure-dashboard-platform-6585-6595/main_frontend_app/src/app/core/services/auth.service.ts", "pattern": "/^export interface AuthResponse { token?: string; requiresOtp?: boolean; otpToken?: string; }$/", "language": "TypeScript", "kind": "interface"}, {"_type": "tag", "name": "AuthService", "path": "/home/kavia/workspace/code-generation/secure-dashboard-platform-6585-6595/main_frontend_app/src/app/core/services/auth.service.ts", "pattern": "/^export class AuthService {$/", "language": "TypeScript", "kind": "class"}, {"_type": "tag", "name": "ForgotPayload", "path": "/home/kavia/workspace/code-generation/secure-dashboard-platform-6585-6595/main_frontend_app/src/app/core/services/auth.service.ts", "pattern": "/^export interface ForgotPayload { email: string; }$/", "language": "TypeScript", "kind": "interface"}, {"_type": "tag", "name": "LoginPayload", "path": "/home/kavia/workspace/code-generation/secure-dashboard-platform-6585-6595/main_frontend_app/src/app/core/services/auth.service.ts", "pattern": "/^export interface LoginPayload { email: string; password: string; }$/", "language": "TypeScript", "kind": "interface"}, {"_type": "tag", "name": "OTP_TOKEN_KEY", "path": "/home/kavia/workspace/code-generation/secure-dashboard-platform-6585-6595/main_frontend_app/src/app/core/services/auth.service.ts", "pattern": "/^  private readonly OTP_TOKEN_KEY = 'otp_token';$/", "language": "TypeScript", "kind": "property", "scope": "AuthService", "scopeKind": "class"}, {"_type": "tag", "name": "OtpPayload", "path": "/home/kavia/workspace/code-generation/secure-dashboard-platform-6585-6595/main_frontend_app/src/app/core/services/auth.service.ts", "pattern": "/^export interface OtpPayload { email: string; otp: string; otpToken: string; }$/", "language": "TypeScript", "kind": "interface"}, {"_type": "tag", "name": "ResetPayload", "path": "/home/kavia/workspace/code-generation/secure-dashboard-platform-6585-6595/main_frontend_app/src/app/core/services/auth.service.ts", "pattern": "/^export interface ResetPayload { token: string; password: string; }$/", "language": "TypeScript", "kind": "interface"}, {"_type": "tag", "name": "TOKEN_KEY", "path": "/home/kavia/workspace/code-generation/secure-dashboard-platform-6585-6595/main_frontend_app/src/app/core/services/auth.service.ts", "pattern": "/^  private readonly TOKEN_KEY = 'auth_token';$/", "language": "TypeScript", "kind": "property", "scope": "AuthService", "scopeKind": "class"}, {"_type": "tag", "name": "body", "path": "/home/kavia/workspace/code-generation/secure-dashboard-platform-6585-6595/main_frontend_app/src/app/core/services/auth.service.ts", "pattern": "/^    const body: OtpPayload = { email: payload.email, otp: payload.otp, otpToken: otpToken || '' /", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "email", "path": "/home/kavia/workspace/code-generation/secure-dashboard-platform-6585-6595/main_frontend_app/src/app/core/services/auth.service.ts", "pattern": "/^export interface ForgotPayload { email: string; }$/", "language": "TypeScript", "kind": "property", "scope": "ForgotPayload", "scopeKind": "interface"}, {"_type": "tag", "name": "email", "path": "/home/kavia/workspace/code-generation/secure-dashboard-platform-6585-6595/main_frontend_app/src/app/core/services/auth.service.ts", "pattern": "/^export interface LoginPayload { email: string; password: string; }$/", "language": "TypeScript", "kind": "property", "scope": "LoginPayload", "scopeKind": "interface"}, {"_type": "tag", "name": "email", "path": "/home/kavia/workspace/code-generation/secure-dashboard-platform-6585-6595/main_frontend_app/src/app/core/services/auth.service.ts", "pattern": "/^export interface OtpPayload { email: string; otp: string; otpToken: string; }$/", "language": "TypeScript", "kind": "property", "scope": "OtpPayload", "scopeKind": "interface"}, {"_type": "tag", "name": "otp", "path": "/home/kavia/workspace/code-generation/secure-dashboard-platform-6585-6595/main_frontend_app/src/app/core/services/auth.service.ts", "pattern": "/^    const body: OtpPayload = { email: payload.email, otp: payload.otp, otpToken: otpToken || '' /", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "otp", "path": "/home/kavia/workspace/code-generation/secure-dashboard-platform-6585-6595/main_frontend_app/src/app/core/services/auth.service.ts", "pattern": "/^export interface OtpPayload { email: string; otp: string; otpToken: string; }$/", "language": "TypeScript", "kind": "property", "scope": "OtpPayload", "scopeKind": "interface"}, {"_type": "tag", "name": "otpToken", "path": "/home/kavia/workspace/code-generation/secure-dashboard-platform-6585-6595/main_frontend_app/src/app/core/services/auth.service.ts", "pattern": "/^    const body: OtpPayload = { email: payload.email, otp: payload.otp, otpToken: otpToken || '' /", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "otpToken", "path": "/home/kavia/workspace/code-generation/secure-dashboard-platform-6585-6595/main_frontend_app/src/app/core/services/auth.service.ts", "pattern": "/^    const otpToken = this.getOtpToken();$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "otpToken", "path": "/home/kavia/workspace/code-generation/secure-dashboard-platform-6585-6595/main_frontend_app/src/app/core/services/auth.service.ts", "pattern": "/^export interface AuthResponse { token?: string; requiresOtp?: boolean; otpToken?: string; }$/", "language": "TypeScript", "kind": "property", "scope": "AuthResponse", "scopeKind": "interface"}, {"_type": "tag", "name": "otpToken", "path": "/home/kavia/workspace/code-generation/secure-dashboard-platform-6585-6595/main_frontend_app/src/app/core/services/auth.service.ts", "pattern": "/^export interface OtpPayload { email: string; otp: string; otpToken: string; }$/", "language": "TypeScript", "kind": "property", "scope": "OtpPayload", "scopeKind": "interface"}, {"_type": "tag", "name": "password", "path": "/home/kavia/workspace/code-generation/secure-dashboard-platform-6585-6595/main_frontend_app/src/app/core/services/auth.service.ts", "pattern": "/^export interface LoginPayload { email: string; password: string; }$/", "language": "TypeScript", "kind": "property", "scope": "LoginPayload", "scopeKind": "interface"}, {"_type": "tag", "name": "password", "path": "/home/kavia/workspace/code-generation/secure-dashboard-platform-6585-6595/main_frontend_app/src/app/core/services/auth.service.ts", "pattern": "/^export interface ResetPayload { token: string; password: string; }$/", "language": "TypeScript", "kind": "property", "scope": "ResetPayload", "scopeKind": "interface"}, {"_type": "tag", "name": "platformId", "path": "/home/kavia/workspace/code-generation/secure-dashboard-platform-6585-6595/main_frontend_app/src/app/core/services/auth.service.ts", "pattern": "/^  private platformId = inject(PLATFORM_ID);$/", "language": "TypeScript", "kind": "property", "scope": "AuthService", "scopeKind": "class"}, {"_type": "tag", "name": "requiresOtp", "path": "/home/kavia/workspace/code-generation/secure-dashboard-platform-6585-6595/main_frontend_app/src/app/core/services/auth.service.ts", "pattern": "/^export interface AuthResponse { token?: string; requiresOtp?: boolean; otpToken?: string; }$/", "language": "TypeScript", "kind": "property", "scope": "AuthResponse", "scopeKind": "interface"}, {"_type": "tag", "name": "token", "path": "/home/kavia/workspace/code-generation/secure-dashboard-platform-6585-6595/main_frontend_app/src/app/core/services/auth.service.ts", "pattern": "/^export interface AuthResponse { token?: string; requiresOtp?: boolean; otpToken?: string; }$/", "language": "TypeScript", "kind": "property", "scope": "AuthResponse", "scopeKind": "interface"}, {"_type": "tag", "name": "token", "path": "/home/kavia/workspace/code-generation/secure-dashboard-platform-6585-6595/main_frontend_app/src/app/core/services/auth.service.ts", "pattern": "/^export interface ResetPayload { token: string; password: string; }$/", "language": "TypeScript", "kind": "property", "scope": "ResetPayload", "scopeKind": "interface"}], "hash": "0cb535d2a0bfa086f472a6efa5db23ca", "format-version": 4, "code-base-name": "main_frontend_app", "filename": "main_frontend_app/src/app/core/services/auth.service.ts", "fields": [{"name": "export interface AuthResponse { token?: string; requiresOtp?: boolean; otpToken?: string; }", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "export interface ForgotPayload { email: string; }", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "export interface LoginPayload { email: string; password: string; }", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "private readonly OTP_TOKEN_KEY = 'otp_token';", "scope": "AuthService", "scopeKind": "class", "description": "unavailable"}, {"name": "export interface OtpPayload { email: string; otp: string; otpToken: string; }", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "export interface ResetPayload { token: string; password: string; }", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "private readonly TOKEN_KEY = 'auth_token';", "scope": "AuthService", "scopeKind": "class", "description": "unavailable"}, {"name": "private platformId = inject(PLATFORM_ID);", "scope": "AuthService", "scopeKind": "class", "description": "unavailable"}]}