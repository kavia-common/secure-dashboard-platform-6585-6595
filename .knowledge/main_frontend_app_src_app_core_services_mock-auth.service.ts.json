{"is_source_file": true, "format": "TypeScript", "description": "This file defines a MockAuthService class that simulates authentication flows entirely in-browser, mimicking typical auth server behavior for login, OTP verification, password reset, and logout. It is used for testing or development purposes to replace real backend interactions.", "external_files": ["./auth.service"], "external_methods": ["isPlatformBrowser"], "published": ["MockAuthService"], "classes": [{"name": "MockAuthService", "description": "A service class that simulates authentication flows entirely in-browser with an in-memory store, meant to mimic backend authentication processes for testing purposes."}], "methods": [{"name": "login", "description": "Simulates login by validating email/password against a demo user, generating OTP and otpToken for multi-factor authentication."}, {"name": "verifyOtp", "description": "Simulates OTP verification using stored otpToken, issuing a fake JWT token upon success."}, {"name": "forgotPassword", "description": "Simulates the process of requesting a password reset, generating and storing a reset token."}, {"name": "resetPassword", "description": "Simulates password reset by validating a token and updating the in-memory password."}, {"name": "logout", "description": "Clears stored authentication tokens, logging out the user."}, {"name": "isAuthenticated", "description": "Checks whether a user is currently authenticated based on token presence."}, {"name": "getToken", "description": "Retrieves the current authentication token."}, {"name": "function cryptoRandomString(len = 16): string { cryptoRandomString", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "function delayError<T = any>(ms: number, httpErrorShape: any): Observable<T> { delayError", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["delayError", "this.setOtpToken", "this.getOtpToken", "this.setToken", "this.clearOtpToken", "this.getToken", "localStorage?.getItem", "localStorage?.setItem", "localStorage?.removeItem"], "search-terms": ["MockAuthService", "OTP token", "simulated login", "in-memory store", "demo user credentials", "fake JWT", "password reset token"], "state": 2, "file_id": 34, "knowledge_revision": 123, "git_revision": "", "revision_history": [{"115": ""}, {"122": ""}, {"123": ""}], "ctags": [{"_type": "tag", "name": "MockAuthService", "path": "/home/kavia/workspace/code-generation/secure-dashboard-platform-6585-6595/main_frontend_app/src/app/core/services/mock-auth.service.ts", "pattern": "/^export class MockAuthService {$/", "language": "TypeScript", "kind": "class"}, {"_type": "tag", "name": "OTP_TOKEN_KEY", "path": "/home/kavia/workspace/code-generation/secure-dashboard-platform-6585-6595/main_frontend_app/src/app/core/services/mock-auth.service.ts", "pattern": "/^  private readonly OTP_TOKEN_KEY = 'otp_token';$/", "language": "TypeScript", "kind": "property", "scope": "MockAuthService", "scopeKind": "class"}, {"_type": "tag", "name": "TOKEN_KEY", "path": "/home/kavia/workspace/code-generation/secure-dashboard-platform-6585-6595/main_frontend_app/src/app/core/services/mock-auth.service.ts", "pattern": "/^  private readonly TOKEN_KEY = 'auth_token';$/", "language": "TypeScript", "kind": "property", "scope": "MockAuthService", "scopeKind": "class"}, {"_type": "tag", "name": "arr", "path": "/home/kavia/workspace/code-generation/secure-dashboard-platform-6585-6595/main_frontend_app/src/app/core/services/mock-auth.service.ts", "pattern": "/^      const arr = new Uint8Array(len);$/", "language": "TypeScript", "kind": "constant", "scope": "cryptoRandomString", "scopeKind": "function"}, {"_type": "tag", "name": "cryptoRandomString", "path": "/home/kavia/workspace/code-generation/secure-dashboard-platform-6585-6595/main_frontend_app/src/app/core/services/mock-auth.service.ts", "pattern": "/^function cryptoRandomString(len = 16): string {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "delayError", "path": "/home/kavia/workspace/code-generation/secure-dashboard-platform-6585-6595/main_frontend_app/src/app/core/services/mock-auth.service.ts", "pattern": "/^function delayError<T = any>(ms: number, httpErrorShape: any): Observable<T> {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "email", "path": "/home/kavia/workspace/code-generation/secure-dashboard-platform-6585-6595/main_frontend_app/src/app/core/services/mock-auth.service.ts", "pattern": "/^    const email = payload?.email || '';$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "email", "path": "/home/kavia/workspace/code-generation/secure-dashboard-platform-6585-6595/main_frontend_app/src/app/core/services/mock-auth.service.ts", "pattern": "/^    const { email, password } = payload || ({} as LoginPayload);$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "email", "path": "/home/kavia/workspace/code-generation/secure-dashboard-platform-6585-6595/main_frontend_app/src/app/core/services/mock-auth.service.ts", "pattern": "/^    for (const [email, t] of this.resetTokenByEmail.entries()) {$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "fakeJwt", "path": "/home/kavia/workspace/code-generation/secure-dashboard-platform-6585-6595/main_frontend_app/src/app/core/services/mock-auth.service.ts", "pattern": "/^    const fakeJwt = this.randomToken('jwt');$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "g", "path": "/home/kavia/workspace/code-generation/secure-dashboard-platform-6585-6595/main_frontend_app/src/app/core/services/mock-auth.service.ts", "pattern": "/^    const g: any = globalThis as any;$/", "language": "TypeScript", "kind": "constant", "scope": "cryptoRandomString", "scopeKind": "function"}, {"_type": "tag", "name": "g", "path": "/home/kavia/workspace/code-generation/secure-dashboard-platform-6585-6595/main_frontend_app/src/app/core/services/mock-auth.service.ts", "pattern": "/^    const g: any = globalThis as any;$/", "language": "TypeScript", "kind": "constant", "scope": "delayError", "scopeKind": "function"}, {"_type": "tag", "name": "id", "path": "/home/kavia/workspace/code-generation/secure-dashboard-platform-6585-6595/main_frontend_app/src/app/core/services/mock-auth.service.ts", "pattern": "/^    const id = g.setTimeout(() => subscriber.error(httpErrorShape), ms);$/", "language": "TypeScript", "kind": "constant", "scope": "delayError", "scopeKind": "function"}, {"_type": "tag", "name": "matchedEmail", "path": "/home/kavia/workspace/code-generation/secure-dashboard-platform-6585-6595/main_frontend_app/src/app/core/services/mock-auth.service.ts", "pattern": "/^    let matchedEmail: string | null = null;$/", "language": "TypeScript", "kind": "variable"}, {"_type": "tag", "name": "n", "path": "/home/kavia/workspace/code-generation/secure-dashboard-platform-6585-6595/main_frontend_app/src/app/core/services/mock-auth.service.ts", "pattern": "/^    const n = cryptoRandomString(24);$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "otpToken", "path": "/home/kavia/workspace/code-generation/secure-dashboard-platform-6585-6595/main_frontend_app/src/app/core/services/mock-auth.service.ts", "pattern": "/^    const otpToken = this.getOtpToken();$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "otpToken", "path": "/home/kavia/workspace/code-generation/secure-dashboard-platform-6585-6595/main_frontend_app/src/app/core/services/mock-auth.service.ts", "pattern": "/^    const res: AuthResponse = { requiresOtp: true, otpToken: this.currentOtpToken };$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "password", "path": "/home/kavia/workspace/code-generation/secure-dashboard-platform-6585-6595/main_frontend_app/src/app/core/services/mock-auth.service.ts", "pattern": "/^    const { email, password } = payload || ({} as LoginPayload);$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "password", "path": "/home/kavia/workspace/code-generation/secure-dashboard-platform-6585-6595/main_frontend_app/src/app/core/services/mock-auth.service.ts", "pattern": "/^    const { token, password } = payload || ({} as ResetPayload);$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "platformId", "path": "/home/kavia/workspace/code-generation/secure-dashboard-platform-6585-6595/main_frontend_app/src/app/core/services/mock-auth.service.ts", "pattern": "/^  private platformId = inject(PLATFORM_ID);$/", "language": "TypeScript", "kind": "property", "scope": "MockAuthService", "scopeKind": "class"}, {"_type": "tag", "name": "res", "path": "/home/kavia/workspace/code-generation/secure-dashboard-platform-6585-6595/main_frontend_app/src/app/core/services/mock-auth.service.ts", "pattern": "/^    const res: AuthResponse = { requiresOtp: true, otpToken: this.currentOtpToken };$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "t", "path": "/home/kavia/workspace/code-generation/secure-dashboard-platform-6585-6595/main_frontend_app/src/app/core/services/mock-auth.service.ts", "pattern": "/^    for (const [email, t] of this.resetTokenByEmail.entries()) {$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "token", "path": "/home/kavia/workspace/code-generation/secure-dashboard-platform-6585-6595/main_frontend_app/src/app/core/services/mock-auth.service.ts", "pattern": "/^    const token = this.randomToken('reset');$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "token", "path": "/home/kavia/workspace/code-generation/secure-dashboard-platform-6585-6595/main_frontend_app/src/app/core/services/mock-auth.service.ts", "pattern": "/^    const { token, password } = payload || ({} as ResetPayload);$/", "language": "TypeScript", "kind": "constant"}], "hash": "10302bcdbffe785bd358a85dfff14363", "format-version": 4, "code-base-name": "main_frontend_app", "filename": "main_frontend_app/src/app/core/services/mock-auth.service.ts", "fields": [{"name": "private readonly OTP_TOKEN_KEY = 'otp_token';", "scope": "MockAuthService", "scopeKind": "class", "description": "unavailable"}, {"name": "private readonly TOKEN_KEY = 'auth_token';", "scope": "MockAuthService", "scopeKind": "class", "description": "unavailable"}, {"name": "let matchedEmail: string | null = null;", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "private platformId = inject(PLATFORM_ID);", "scope": "MockAuthService", "scopeKind": "class", "description": "unavailable"}]}