{"is_source_file": true, "format": "TypeScript", "description": "This file defines a MockAuthService class that simulates authentication flows in-memory for testing purposes. It provides methods for login, OTP verification, password reset, and logout, mimicking a real AuthService but operating entirely within the browser memory or localStorage.", "external_files": ["./auth.service"], "external_methods": ["isPlatformBrowser"], "published": ["MockAuthService"], "classes": [{"name": "MockAuthService", "description": "A mock implementation of an authentication service that handles login, OTP verification, password reset, and logout operations entirely in-memory for testing purposes."}], "methods": [{"name": "login", "description": "Simulates login by validating credentials; on success, generates OTP and OTP token."}, {"name": "verifyOtp", "description": "Simulates OTP verification and issues a fake JWT token upon success."}, {"name": "forgotPassword", "description": "Simulates password reset request by generating a reset token."}, {"name": "resetPassword", "description": "Simulates resetting the password given a valid reset token."}, {"name": "logout", "description": "Clears stored tokens and marks user as logged out."}, {"name": "isAuthenticated", "description": "Checks if a user is currently authenticated."}, {"name": "getToken", "description": "Retrieves the current authentication token."}, {"name": "function cryptoRandomString(len = 16): string { cryptoRandomString", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "function delayError<T = any>(ms: number, httpErrorShape: any): Observable<T> { delayError", "scope": "", "scopeKind": "", "description": "unavailable"}], "calls": ["delayError", "this.setOtpToken", "this.setToken", "this.getOtpToken", "this.clearOtpToken", "localStorage.getItem", "localStorage.setItem", "localStorage.removeItem"], "search-terms": ["MockAuthService", "simulate login OTP", "in-memory reset token", "demo user credentials", "mock authentication", "fake JWT", "OTP validation"], "state": 2, "file_id": 34, "knowledge_revision": 126, "git_revision": "a081834603dc400dce1c5b99b4514e8b379a74b1", "revision_history": [{"115": ""}, {"122": ""}, {"123": ""}, {"125": "39362a197a1ebb327854facf74a26597dbb795ce"}, {"126": "a081834603dc400dce1c5b99b4514e8b379a74b1"}], "ctags": [{"_type": "tag", "name": "MockAuthService", "path": "/home/kavia/workspace/code-generation/secure-dashboard-platform-6585-6595/main_frontend_app/src/app/core/services/mock-auth.service.ts", "pattern": "/^export class MockAuthService {$/", "language": "TypeScript", "kind": "class"}, {"_type": "tag", "name": "OTP_TOKEN_KEY", "path": "/home/kavia/workspace/code-generation/secure-dashboard-platform-6585-6595/main_frontend_app/src/app/core/services/mock-auth.service.ts", "pattern": "/^  private readonly OTP_TOKEN_KEY = 'otp_token';$/", "language": "TypeScript", "kind": "property", "scope": "MockAuthService", "scopeKind": "class"}, {"_type": "tag", "name": "TOKEN_KEY", "path": "/home/kavia/workspace/code-generation/secure-dashboard-platform-6585-6595/main_frontend_app/src/app/core/services/mock-auth.service.ts", "pattern": "/^  private readonly TOKEN_KEY = 'auth_token';$/", "language": "TypeScript", "kind": "property", "scope": "MockAuthService", "scopeKind": "class"}, {"_type": "tag", "name": "arr", "path": "/home/kavia/workspace/code-generation/secure-dashboard-platform-6585-6595/main_frontend_app/src/app/core/services/mock-auth.service.ts", "pattern": "/^      const arr = new Uint8Array(len);$/", "language": "TypeScript", "kind": "constant", "scope": "cryptoRandomString", "scopeKind": "function"}, {"_type": "tag", "name": "cryptoRandomString", "path": "/home/kavia/workspace/code-generation/secure-dashboard-platform-6585-6595/main_frontend_app/src/app/core/services/mock-auth.service.ts", "pattern": "/^function cryptoRandomString(len = 16): string {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "delayError", "path": "/home/kavia/workspace/code-generation/secure-dashboard-platform-6585-6595/main_frontend_app/src/app/core/services/mock-auth.service.ts", "pattern": "/^function delayError<T = any>(ms: number, httpErrorShape: any): Observable<T> {$/", "language": "TypeScript", "kind": "function"}, {"_type": "tag", "name": "email", "path": "/home/kavia/workspace/code-generation/secure-dashboard-platform-6585-6595/main_frontend_app/src/app/core/services/mock-auth.service.ts", "pattern": "/^    const email = payload?.email || '';$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "email", "path": "/home/kavia/workspace/code-generation/secure-dashboard-platform-6585-6595/main_frontend_app/src/app/core/services/mock-auth.service.ts", "pattern": "/^    const { email, password } = payload || ({} as LoginPayload);$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "email", "path": "/home/kavia/workspace/code-generation/secure-dashboard-platform-6585-6595/main_frontend_app/src/app/core/services/mock-auth.service.ts", "pattern": "/^    for (const [email, t] of this.resetTokenByEmail.entries()) {$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "fakeJwt", "path": "/home/kavia/workspace/code-generation/secure-dashboard-platform-6585-6595/main_frontend_app/src/app/core/services/mock-auth.service.ts", "pattern": "/^    const fakeJwt = this.randomToken('jwt');$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "g", "path": "/home/kavia/workspace/code-generation/secure-dashboard-platform-6585-6595/main_frontend_app/src/app/core/services/mock-auth.service.ts", "pattern": "/^    const g: any = globalThis as any;$/", "language": "TypeScript", "kind": "constant", "scope": "cryptoRandomString", "scopeKind": "function"}, {"_type": "tag", "name": "g", "path": "/home/kavia/workspace/code-generation/secure-dashboard-platform-6585-6595/main_frontend_app/src/app/core/services/mock-auth.service.ts", "pattern": "/^    const g: any = globalThis as any;$/", "language": "TypeScript", "kind": "constant", "scope": "delayError", "scopeKind": "function"}, {"_type": "tag", "name": "id", "path": "/home/kavia/workspace/code-generation/secure-dashboard-platform-6585-6595/main_frontend_app/src/app/core/services/mock-auth.service.ts", "pattern": "/^    const id = g.setTimeout(() => subscriber.error(httpErrorShape), ms);$/", "language": "TypeScript", "kind": "constant", "scope": "delayError", "scopeKind": "function"}, {"_type": "tag", "name": "matchedEmail", "path": "/home/kavia/workspace/code-generation/secure-dashboard-platform-6585-6595/main_frontend_app/src/app/core/services/mock-auth.service.ts", "pattern": "/^    let matchedEmail: string | null = null;$/", "language": "TypeScript", "kind": "variable"}, {"_type": "tag", "name": "n", "path": "/home/kavia/workspace/code-generation/secure-dashboard-platform-6585-6595/main_frontend_app/src/app/core/services/mock-auth.service.ts", "pattern": "/^    const n = cryptoRandomString(24);$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "otpToken", "path": "/home/kavia/workspace/code-generation/secure-dashboard-platform-6585-6595/main_frontend_app/src/app/core/services/mock-auth.service.ts", "pattern": "/^    const otpToken = this.getOtpToken();$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "otpToken", "path": "/home/kavia/workspace/code-generation/secure-dashboard-platform-6585-6595/main_frontend_app/src/app/core/services/mock-auth.service.ts", "pattern": "/^    const res: AuthResponse = { requiresOtp: true, otpToken: this.currentOtpToken };$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "password", "path": "/home/kavia/workspace/code-generation/secure-dashboard-platform-6585-6595/main_frontend_app/src/app/core/services/mock-auth.service.ts", "pattern": "/^    const { email, password } = payload || ({} as LoginPayload);$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "password", "path": "/home/kavia/workspace/code-generation/secure-dashboard-platform-6585-6595/main_frontend_app/src/app/core/services/mock-auth.service.ts", "pattern": "/^    const { token, password } = payload || ({} as ResetPayload);$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "platformId", "path": "/home/kavia/workspace/code-generation/secure-dashboard-platform-6585-6595/main_frontend_app/src/app/core/services/mock-auth.service.ts", "pattern": "/^  private platformId = inject(PLATFORM_ID);$/", "language": "TypeScript", "kind": "property", "scope": "MockAuthService", "scopeKind": "class"}, {"_type": "tag", "name": "res", "path": "/home/kavia/workspace/code-generation/secure-dashboard-platform-6585-6595/main_frontend_app/src/app/core/services/mock-auth.service.ts", "pattern": "/^    const res: AuthResponse = { requiresOtp: true, otpToken: this.currentOtpToken };$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "t", "path": "/home/kavia/workspace/code-generation/secure-dashboard-platform-6585-6595/main_frontend_app/src/app/core/services/mock-auth.service.ts", "pattern": "/^    for (const [email, t] of this.resetTokenByEmail.entries()) {$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "token", "path": "/home/kavia/workspace/code-generation/secure-dashboard-platform-6585-6595/main_frontend_app/src/app/core/services/mock-auth.service.ts", "pattern": "/^    const token = this.randomToken('reset');$/", "language": "TypeScript", "kind": "constant"}, {"_type": "tag", "name": "token", "path": "/home/kavia/workspace/code-generation/secure-dashboard-platform-6585-6595/main_frontend_app/src/app/core/services/mock-auth.service.ts", "pattern": "/^    const { token, password } = payload || ({} as ResetPayload);$/", "language": "TypeScript", "kind": "constant"}], "hash": "725d6adbc246b31320b028048570dba9", "format-version": 4, "code-base-name": "main_frontend_app", "filename": "main_frontend_app/src/app/core/services/mock-auth.service.ts", "fields": [{"name": "private readonly OTP_TOKEN_KEY = 'otp_token';", "scope": "MockAuthService", "scopeKind": "class", "description": "unavailable"}, {"name": "private readonly TOKEN_KEY = 'auth_token';", "scope": "MockAuthService", "scopeKind": "class", "description": "unavailable"}, {"name": "let matchedEmail: string | null = null;", "scope": "", "scopeKind": "", "description": "unavailable"}, {"name": "private platformId = inject(PLATFORM_ID);", "scope": "MockAuthService", "scopeKind": "class", "description": "unavailable"}]}